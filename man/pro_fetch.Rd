% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pro_fetch.R
\name{pro_fetch}
\alias{pro_fetch}
\title{Fetch and convert OpenAlex data}
\usage{
pro_fetch(
  query_url,
  pages = 1000,
  project_folder = NULL,
  overwrite = FALSE,
  mailto = oap_mail(),
  api_key = oap_apikey,
  workers = 1,
  verbose = FALSE,
  progress = TRUE,
  count_only,
  error_log = NULL
)
}
\arguments{
\item{query_url}{The URL of the API query or a list of URLs returned from \code{pro_query()}.}

\item{pages}{The number of pages to be downloaded. The default is set to
1000, which would be 2,000,000 works. It is recommended to not increase it
beyond 1000 due to server load and to use the snapshot instead. If \code{NULL},
all pages will be downloaded. Default: 1000.}

\item{project_folder}{Directory where all intermediate (\code{json},
\code{jsonl}) and final (\code{parquet}) results are stored.
If it does not exist, it is created. If \code{NULL}, a temporary
directory is created.}

\item{overwrite}{Logical. If \code{TRUE}, \code{output} will be deleted if it already
exists.}

\item{mailto}{The email address of the user. See \code{oap_mail()}.}

\item{api_key}{The API key of the user. See \code{oap_apikey()}.}

\item{workers}{Number of parallel workers to use if \code{query_url} is a list. Defaults to 1.}

\item{verbose}{Logical indicating whether to show verbose messages.}

\item{progress}{Logical default \code{TRUE} indicating whether to show a progress
bar.}

\item{count_only}{Do not use it here. The function will abort if it set to
\code{TRUE} and give a warning if \code{FALSE}}

\item{error_log}{location of error log of API calls. (default: \code{NULL} (none)).}
}
\value{
Invisibly, the normalized path of the \code{parquet} subfolder
inside \code{project_folder}, i.e. the value returned by
\code{pro_request_jsonl_parquet()}.
}
\description{
Convenience wrapper around \code{\link{pro_request}},
\code{\link{pro_request_jsonl}} and
\code{\link{pro_request_jsonl_parquet}}.
}
\details{
The function
\itemize{
\item downloads records from OpenAlex via \code{pro_request()} into a
\code{"json"} subfolder of \code{project_folder},
\item converts the JSON files to \code{jsonl} via
\code{pro_request_jsonl()} into a \code{"jsonl"} subfolder, and
\item converts the jsonl files to an Apache Parquet dataset via
\code{pro_request_jsonl_parquet()} into a \code{"parquet"} subfolder.
}

This is a high-level helper for the common workflow of going from an
OpenAlex query URL to a local Parquet dataset in a single call.
In most cases, this function should be sufficient, but if more control is needed,
the individual functions have to be called separately.

\strong{This function assumes \code{count_only == FALSE}}
}
