<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Providing a more advanced access to OpenAlex for the power user • openalexPro</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Providing a more advanced access to OpenAlex for the power user">
<meta name="description" content="More about what it does (maybe more than one line).">
<meta property="og:description" content="More about what it does (maybe more than one line).">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">openalexPro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Workflow.html">Workflow using `openalexPro2`</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rkrug/openalexPro/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="this-package-is-experimental">This Package is experimental!<a class="anchor" aria-label="anchor" href="#this-package-is-experimental"></a>
</h1></div>
</div>
<div class="section level1">
<h1 id="use-at-own-risk-but-please-let-me-know-if-things-do-not-work">Use at own risk, but please let me know if things do not work!<a class="anchor" aria-label="anchor" href="#use-at-own-risk-but-please-let-me-know-if-things-do-not-work"></a>
</h1>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This package sopplements <a href="https://github.com/openalex/openalexR" class="external-link">openalexR</a> by providing a more advanced access to OpenAlex for the power user. <code>openalexR</code> does all computations an conversions in memory. This is extremely useful for smaller datasets downloaded from <a href="https://openalex.org" class="external-link">OpenAlex</a>, but not practical for larger corpora which would require too much memory. <code>openalexPro2</code> does, in contrast, only processes smaller batches (i.e. the individual pages returned by the OpenAlex API) in memory and utilises other frameworks like <a href="https://duckdb.org" class="external-link">DuckDB</a> and the parquet file format, part of <a href="https://arrow.apache.org" class="external-link">Arrow</a> if larger amounts need to be processed. This has the advantage to provide a tool to download several millions or records (in one project I downloaded 5.5. million) which would not be possible using <code>openalexR</code>.</p>
<p><code>openalexProo2</code> uses the function <code>openalexR:oa_query()</code> to build the query, and uses its own download mechaniism to download the results.</p>
<p>The core idea of this package is, as hinted above, to not load all results in memory and convert them (which causes memory bottlenecks in <code>oepenalexR</code> but is very useful for smaller return corpi) but rather save each page returned, including all headers, as individual json files in a directory.</p>
<p>These json files are processed further by additional functions. One can directly process th json functions, or the final parquet dataset for further analysis.</p>
<p>It is planned to build additional acompanying packages using these data structures which provide functions to plot snowball searches, to analyse the corus, etc.</p>
<p>A final aim is to make these acompanying packages compatible to <code>openalexR</code> outputs, so that one can easily switch from one to the other if the size of the corpus increases.</p>
</div>
<div class="section level2">
<h2 id="design-principles">Design Principles<a class="anchor" aria-label="anchor" href="#design-principles"></a>
</h2>
<p>Due to the requirement of <code>openalexPro2</code> to handle huge corpi with several millions of works, an efficient storage format needs to be provided as a backend. For download the json files are the easiest to use, but for retrieval other formats are more suitable.</p>
<p>The format which is used in this package is the <code>parquet</code> format which is space efficient and in the retrieveal of data (see <a href="https://parquet.apache.org/docs/" class="external-link uri">https://parquet.apache.org/docs/</a> for a detailed description of the format). It interfaces for example directly with <code>dplyr</code>, so that one can do a lot of processing before even collecting the actual data, i.e. enabling processing of larger-then-memory datasets.</p>
<p>In addition, as a link between json files, the parquet dataset, and the retrieval of works from the dataset, the <code>duckdb</code> package is used. ‘<a href="https://duckdb.org" class="external-link">DuckDB</a> is a fast in-process analytical database’ as described by them and it integrates peferfectly with <code>parquet</code> and ‘json’ files as well as the <code>dplyr</code> pipelines.</p>
<p>The last wheel in the puzzle is the extraction of the actual references from the returned json files as well as the conversion of the abstracts from the inverted index format returned by OpenAlex and the creation of short citations (Author, et al (2020)). This is done by the tool <a href="https://stedolan.github.io/jq/" class="external-link">jq</a> in the <a href="https://github.com/rkrug/jqr" class="external-link"><code>jqr</code></a> package.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The “stable” version is available via <a href="https://rkrug.r-universe.dev/openalexPro2" class="external-link">r-universe</a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'openalexPro2'</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'https://rkrug.r-universe.dev'</span>, <span class="st">'https://cloud.r-project.org'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The “development” version can be installed from github using</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"rkrug/openalexPro"</span>, ref <span class="op">=</span> <span class="st">"openalexPro2"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-workflow-for-searches">Basic Workflow for Searches<a class="anchor" aria-label="anchor" href="#basic-workflow-for-searches"></a>
</h2>
<p>Depending on the search query, the results are either a single record, grpouped records or a table of records.</p>
<p>This workflow can be stoped at any of the stages, and the json files can be processed using own functions.</p>
<div class="section level3">
<h3 id="id_1-define-query">1. Define query<a class="anchor" aria-label="anchor" href="#id_1-define-query"></a>
</h3>
<p>The query is defined using the function <code>openalexR:oa_query()</code>. For details about arguments and how to use it, please see there. For convenience, it is re-published in the <code>openalexPro2</code> package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">openalexPro2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">oa_query</span><span class="op">(</span></span>
<span>  title_and_abstract.search <span class="op">=</span> <span class="st">"biodiversity AND conservation AND IPBES"</span>,</span>
<span>  entity <span class="op">=</span> <span class="st">"works"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_2-download-json-files">2. Download <code>json</code> files<a class="anchor" aria-label="anchor" href="#id_2-download-json-files"></a>
</h3>
<p>The returned jsons are saved as jsons on the disk in the folder provided by the argument <code>output</code>. They contain metadata from the request as well as the results.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_raw</span> <span class="op">&lt;-</span> <span class="st">"./json_raw"</span></span>
<span><span class="fu">openalexPro2</span><span class="fu">::</span><span class="fu">pro_request</span><span class="op">(</span></span>
<span>  query_url <span class="op">=</span> <span class="va">query_url</span>,</span>
<span>  output <span class="op">=</span> <span class="va">json_raw</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  json_dir <span class="op">=</span> <span class="st">"json_files"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_3-process-json-files">3. Process <code>json</code> files<a class="anchor" aria-label="anchor" href="#id_3-process-json-files"></a>
</h3>
<p>The processing of the json files is doing the following:</p>
<ol style="list-style-type: decimal">
<li>extracting of the results from the raw json</li>
<li>extracting of the abstracts from the inverted index format</li>
<li>creation of short citations</li>
</ol>
<p>The results are saved in the folder provided by the argument <code>output</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_extracted</span> <span class="op">&lt;-</span> <span class="st">"./json_extracted"</span></span>
<span><span class="va">openalex_jsonl_folder</span> <span class="op">&lt;-</span> <span class="fu">openalexPoro2</span><span class="fu">::</span><span class="fu">pro_request_jsonl</span><span class="op">(</span></span>
<span>  json_dir <span class="op">=</span> <span class="st">"json_files"</span>,</span>
<span>  output <span class="op">=</span> <span class="va">json_extracted</span>,</span>
<span>  verbose <span class="op">=</span> <span class="va">TRUE0</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_4-convert-to-parquet">4. Convert to <code>parquet</code>
<a class="anchor" aria-label="anchor" href="#id_4-convert-to-parquet"></a>
</h3>
<p>Here the files are converted into a parquet dataset saved as individual <code>parquet</code> files in the folder provided by the argument <code>output</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parquet</span> <span class="op">&lt;-</span> <span class="st">"./parquet"</span></span>
<span><span class="fu">openalexPro2</span><span class="fu">::</span><span class="fu">pro_request_jsonl_parquet</span><span class="op">(</span></span>
<span>  json_dir <span class="op">=</span> <span class="va">json_extracted</span>,</span>
<span>  output <span class="op">=</span> <span class="va">parquet</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="basic-workflow-for-snowball-searches">Basic Workflow for Snowball Searches<a class="anchor" aria-label="anchor" href="#basic-workflow-for-snowball-searches"></a>
</h2>
<p>In addition to “normal” searches, snowball searches are implemented. These are searches based on the cited and citing relationships between works. It starts from some key papers and identifies all papers which are citing tthen or are cited by them.</p>
<div class="section level3">
<h3 id="id_1-define-keypapers">1. Define Keypapers<a class="anchor" aria-label="anchor" href="#id_1-define-keypapers"></a>
</h3>
<p>The keypapers can be identified by either their DOIs or their OpenAlex ids.</p>
</div>
<div class="section level3">
<h3 id="id_2-do-the-snowball-search">2. Do the snowball search<a class="anchor" aria-label="anchor" href="#id_2-do-the-snowball-search"></a>
</h3>
<p>The snowball search creates several sub-folders in the <code>output</code> folder (assumed it is called <code>snowball</code>):</p>
<pre><code>snowball/
├── cited_json/
├── cited_jsonl/
├── citing_json/
├── citing_jsonl/
├── edges/
├── keypaper_json/
├── keypaper_jsonl/
├── keypaper_parquet/
└── nodes/</code></pre>
<p>These contain the following files:</p>
<ul>
<li>
<strong>raw <code>json</code> files returned</strong> (<code>cited_json</code>, <code>citing_json</code>, <code>keypaper_json</code>),</li>
<li>
<strong>processsed <code>json</code> files</strong> (<code>cited_jsonl</code>, <code>citing_jsonl</code>, <code>keypaper_jsonl</code>),</li>
<li>
<strong><code>parquet</code> database of the keypaper</strong> (<code>keypaper_parquet</code>) and the</li>
<li>
<strong><code>nodes</code> and <code>edges</code></strong> of the snowball search as <code>parquet</code> databases.</li>
</ul>
<div class="section level4">
<h4 id="use-openalex-ids">Use OpenAlex ids<a class="anchor" aria-label="anchor" href="#use-openalex-ids"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">snowball_dir</span> <span class="op">&lt;-</span> <span class="st">"./snowball_ids"</span></span>
<span><span class="va">snowball_docs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pro_snowball.html">pro_snowball</a></span><span class="op">(</span></span>
<span>  identifier <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"W2741809807"</span>, <span class="st">"W2755950973"</span><span class="op">)</span>,</span>
<span>  output <span class="op">=</span> <span class="va">snowball_dir</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="use-dois">Use DOIs<a class="anchor" aria-label="anchor" href="#use-dois"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">snowball_dir_dois</span> <span class="op">&lt;-</span> <span class="st">"./snowball_dois"</span></span>
<span><span class="fu">oa_snowball</span><span class="op">(</span></span>
<span>  doi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10.1016/j.joi.2017.08.007"</span>, <span class="st">"10.7717/peerj.4375"</span><span class="op">)</span>,</span>
<span>  output <span class="op">=</span> <span class="va">snowball_dir_dois</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="read-data">Read Data<a class="anchor" aria-label="anchor" href="#read-data"></a>
</h2>
<p>The package provides two convenience function for reading obtained data:</p>
<ul>
<li>
<strong><code><a href="reference/read_corpus.html">read_corpus()</a></code></strong> which reads the corpus either as a <code>Dataset</code> object if <code>rearn_data = FALSE</code> or a <code>data.frame</code>, i.e. a data table, if <code>rearn_data = TRUE</code>.</li>
<li>
<strong><code><a href="reference/read_snowball.html">read_snowball()</a></code></strong> which reads the snowball search. The function returns a <code>list</code> which contains to elemends, <code>nodes</code> and <code>edges</code>. Depending on <code>return_data</code> argument these are each a <code>Dataset</code> or a <code>data.frame</code>. The format resulting from <code>read_snowball(read_data = TRUE)</code> is in most practical purposes compatible to the <code>openalexR</code> <code>data.frame</code> or <code>tibble</code> output.</li>
</ul>
<p>The <code>Dataset</code> can be processed further using <code>dplyr</code> functions withiut actually reading the data. You can read the data finally with <code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">dplyr::collect()</a></code>.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/rkrug/openalexPro/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/rkrug/openalexPro/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing openalexPro</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Rainer M Krug <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rainer M Krug.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
